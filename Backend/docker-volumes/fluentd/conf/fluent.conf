<source>
  @type forward
  port 24224
  bind 0.0.0.0
</source>

<match **>
  @type elasticsearch
  host 172.18.0.5
  port 9200
  scheme http
  logstash_format true
  index_name fluentd-logs
  reload_connections true
  reconnect_on_error true
  reload_on_failure true
  time_key @timestamp
  time_key_format %Y-%m-%dT%H:%M:%S.%L%z

  <buffer>
    chunk_limit_size 8MB
    queue_limit_length 512
    flush_thread_count 2
    retry_max_times 17
    retry_wait 5s
  </buffer>
</match>

<label @FLUENT_LOG>
  <match fluent.**>
    @type elasticsearch
    host 172.18.0.5
      user elastic
      password admin
    port 9200
    index_name fluentd-internal-logs
    logstash_format true
  </match>
</label>